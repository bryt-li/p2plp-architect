
@startuml

component [Clients - Web and APP] as CLIENTS
component [Ops Clients - Web] as OPS_CLIENTS

component [Nginx or AWS API Gateway\nReverse Proxy] as NGINX

package "API Server Cluster or AWS Lambda" as API_SERVER_CLUSTER {
	component [Client API Server 1...N] as JACKFRUIT <<Jackfruit>>
	component [Ops API Server 1..N] as MAIZE <<Maize>>
}

package "Redis Cluster or AWS DynamoDB" as REDIS_CLUSTER {
	database "Session Store" as SESSION_DB #999
	database "DB Read Cache" as CACHE_DB #999
}

component [Queue-based Workflow Job Scheduler] as WF_SCHEDULER <<JAVA>>

JACKFRUIT --> WF_SCHEDULER

component [Txn Workflow Server] as LOLLIPOP <<Lollipop>>
component [DragonPay] as DP #grey
component [RobinsonBank] as RB #grey

LOLLIPOP --> DP
LOLLIPOP --> RB

JACKFRUIT .. SESSION_DB
JACKFRUIT .. CACHE_DB
MAIZE .. SESSION_DB
MAIZE .. CACHE_DB

CLIENTS --> NGINX
OPS_CLIENTS --> NGINX

NGINX --> JACKFRUIT
NGINX --> MAIZE


database "Transaction DB" as TXN_DB #eee
LOLLIPOP .. TXN_DB

package "Workflow Server Cluster" as WF_SERVER_CLUSTER {
	component [Loan Workflow Server 1...N] as VOLT <<Volt>>
}

VOLT <--> LOLLIPOP

API_SERVER_CLUSTER --> VOLT
JACKFRUIT --> LOLLIPOP

database "Core DB" as DB #EEE

VOLT . DB : update

CACHE_DB . DB : sync

WF_SCHEDULER --> VOLT

@enduml